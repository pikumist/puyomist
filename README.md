# 概要

ぷよクエのなぞり消し最適解を研究するための [Webアプリ](https://pikumist.github.io/puyomist/) です。

特徴は

- 連鎖シミュレーション
- 属性ダメージやぷよ使いカウントを対象とした最適解計算
- 最適解計算の簡易マルチスレッド対応
- 特別ルールの盤面リスト
- スクリーンショット画像からの盤面セット (チャンスぷよが混じると精度は悪いです)
- 外部通信なし

## 必要な環境

- node.js 22.4.x
- Rust 1.79.0
- wasm-pack 0.13.0

## ローカル環境でのプログラム実行方法

### Webアプリ

```sh
npm run build:wasm && npm run dev
```

http://localhost:5173 にWebアプリが立ち上がります。

### 監視サーバー (任意)

スクリーンショット画像からの盤面セットを楽にするためのサーバーです。
予め登録された監視ディレクトリの中にファイルが追加されると、WebSocket経由でWebアプリに画像ファイルを通知します。
別になくても、Webアプリからも盤面セットはできます。

```sh
npm run server -- [監視するディレクトリのパス]
```

http://localhost:3000 にスクリーンショット画像の監視サーバーが立ち上がります。

デフォルトの監視ディレクトリパスは `/media/ipad/DCIM/100`

## 開発

VSCodeで開発する際は、ワークスペースファイルを用意してあるのでそれを開きます。

```sh
code my.code-workspace
```

わざわざワークスペースファイルを用意しているのは、`Cargo.toml` がワークスペースのトップディレクトリ内にないと、rust-analyzer がプロジェクトの特定に失敗してしまうからです。プロジェクトの絶対パスを指定すれば動かせますが、環境に依存してしまうのでそれは避けています。

## License

[MIT License](LICENSE)
